name: Keep Servers serv00
on:
  schedule:
   - cron: '0 15 */8 * *'
  workflow_dispatch: 

jobs:
  keep_servers_alive:
    runs-on: ubuntu-latest
    env:
      ACCOUNTS: >
        [
        {"SSH_USER":"123456789", "SSH_PASS":"123456", "HOST":"sxxx.serv00.com"}
        ]
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4.2.2

      - name: Install required packages
        run: |
          sudo apt-get update
          sudo apt-get install -y sshpass jq

      - name: Process each account
        run: |
           echo "*****************************************************"
           echo "*****************************************************"
           echo "ç”¬å“¥Githubé¡¹ç›®  ï¼šgithub.com/yonggekkk"
           echo "ç”¬å“¥Bloggeråšå®¢ ï¼šygkkk.blogspot.com"
           echo "ç”¬å“¥YouTubeé¢‘é“ ï¼šwww.youtube.com/@ygkkk"
           echo "vpsæœåŠ¡å™¨è¿œç¨‹ç™»å½•ä¸€æ¬¡SSHè„šæœ¬ã€Githubã€‘"
           echo "*****************************************************"
           echo "*****************************************************"
            count=0  
           for account in $(echo "${ACCOUNTS}" | jq -c '.[]'); do
              count=$((count+1))
              SSH_USER=$(echo $account | jq -r '.SSH_USER')
              SSH_PASS=$(echo $account | jq -r '.SSH_PASS')
              HOST=$(echo $account | jq -r '.HOST')
           if sshpass -p "$SSH_PASS" ssh -o StrictHostKeyChecking=no "$SSH_USER@$HOST" -q exit; then
            echo "ğŸ‰æ­å–œï¼âœ…ç¬¬ã€$countã€‘å°æœåŠ¡å™¨è¿æ¥æˆåŠŸï¼ğŸš€æœåŠ¡å™¨åœ°å€ï¼š$HOST ï¼Œè´¦æˆ·åï¼š$SSH_USER" 
           else
            echo "===================================================="
            echo "ğŸ’¥æ¯å…·ï¼âŒç¬¬ã€$countã€‘å°æœåŠ¡å™¨è¿æ¥å¤±è´¥ï¼ğŸš€æœåŠ¡å™¨åœ°å€ï¼š$HOST ï¼Œè´¦æˆ·åï¼š$SSH_USER"
            echo "âš ï¸å¯èƒ½è´¦å·åã€å¯†ç ã€æœåŠ¡å™¨åç§°è¾“å…¥é”™è¯¯ï¼Œæˆ–è€…å½“å‰æœåŠ¡å™¨åœ¨ç»´æŠ¤ä¸­"  
            echo "===================================================="
           fi
           sleep 10
            done
